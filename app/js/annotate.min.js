!function(a,b){function c(a){for(var b=[];a.parentNode;){if(a.id){b.unshift("#"+a.id);break}if(a==a.ownerDocument.documentElement)b.unshift(a.tagName);else{for(var c=1,d=a;d.previousElementSibling;d=d.previousElementSibling,c++);b.unshift(a.tagName+":nth-child("+c+")")}a=a.parentNode}return b.join(" > ")}function d(a,d){b(".materialize-textarea").val("");var e=window.getSelection().getRangeAt(0),f=e.extractContents(),g=document.createElement("span");if(g.style.backgroundColor=a,g.className="selected-text",void 0!==d)switch(d){case"bold":g.style.fontWeight="bold";break;case"italic":g.style.fontStyle="italic";break;case"underline":g.style.textDecoration="underline";break;case"cross":g.style.textDecoration="line-through"}else g.style.fontWeight="normal",g.style.fontStyle="normal",g.style.textDecoration="none";return g.appendChild(f),e.insertNode(g),{text:g.innerText,parentCSSPath:c(g.parentNode),currentCSSPath:c(g)}}function e(){b("#text-box").find(".selected-text").contents().unwrap()}function f(a){return a.text?G.push({twitterUserID:H,twitterName:I,twitterHandle:J,highlighted_text:a.text,comment:"",path:a.currentCSSPath,parentPath:a.parentCSSPath}):void 0}function g(){var a=".off-annotation, .mdi-action-account-box",c=".on-annotation";b(a).not(c).off("mouseover"),b(a).not(c).off("mouseout"),b(a).not(c).on("mouseover",function(){b(this).css({color:"#26A69A",cursor:"pointer"})}).on("mouseout",function(){b(this).css({color:"white",cursor:"none"})})}function h(a){a.off("mouseout"),a.addClass("on-annotation").removeClass("off-annotation"),a.css("color","#26A69A")}function i(a){a.off("mouseout"),a.on("mouseout",function(){b(this).css("color","white")}),a.addClass("off-annotation").removeClass("on-annotation"),a.css("color","#FFFFFF")}function j(){b(this).hasClass("off-annotation")?h(b(this)):i(b(this)),l(),b(this).one("click",k)}function k(){b(this).hasClass("off-annotation")?h(b(this)):i(b(this)),l(),b(this).one("click",j)}function l(){b(".comment-area").toggle(function(){b(".comment-area").animate({right:"-15%"},"fast")},function(){b(".comment-area").animate({right:"0%"},"fast")})}function m(){h(b(this)),o(),b(this).one("click",n)}function n(){i(b(this)),o(),b(this).one("click",m)}function o(){b(".comment-list").toggle(function(){b(".comment-list").animate({right:"-15%"},"fast")},function(){b(".comment-list").animate({right:"0%"},"fast")})}function p(){i(b(".mdi-editor-mode-edit")),i(b(".mdi-editor-format-italic")),i(b(".mdi-editor-format-color-text")),i(b(".mdi-editor-format-clear")),h(b(this)),g(),b(B).off("mouseup"),b(B).off("mousedown"),b(B).on("mouseup",function(){b(".comment-area textarea").off("keyup");var a=d("#FFFFFF","bold");D=f(a),h(b(".mdi-editor-insert-comment")),("-15%"===b(".comment-area").css("right")||"0%"===b(".comment-area").css("right"))&&b(".comment-area").css("display","block").animate({right:"0%"},"fast"),h(b(".mdi-action-view-headline")),i(b(".mdi-content-archive")),L=!1,("-15%"===b(".comment-list").css("right")||"0%"===b(".comment-list").css("right"))&&b(".comment-list").css("display","block").animate({right:"0%"},"fast"),b(".comment-list .collection").empty();for(var c in M){var e=M[c];e.parentPath==a.parentCSSPath&&b(".comment-list .collection").append('<a href="#!" class="collection-item" style="line-height:0.5rem;" id="'+c+'"><strong>'+e.twitterName+"</strong>: <br/><em style='color: #252525;'>Highlighted Text</em>: <br/><span class='highlighted-text'>"+e.highlighted_text+"</span><br/><em style='color: #252525;''>Comment</em>: <br/><span class='comment-text'>"+e.comment+"</span></li>")}b(".comment-area textarea").focus(),b(".comment-area textarea").keyup(function(){D.update({comment:b(".comment-area textarea").val()})})}),b(B).on("mousedown",function(){e()}),b(this).one("click",q)}function q(){i(b(".mdi-editor-format-bold")),h(b(".mdi-editor-mode-edit")),g(),b(B).off("mouseup"),b(B).off("mousedown"),b(B).on("mouseup",function(){b(".comment-area textarea").off("keyup");var a=d("#FEC324");D=f(a),h(b(".mdi-editor-insert-comment")),("-15%"===b(".comment-area").css("right")||"0%"===b(".comment-area").css("right"))&&b(".comment-area").css("display","block").animate({right:"0%"},"fast"),h(b(".mdi-action-view-headline")),i(b(".mdi-content-archive")),L=!1,("-15%"===b(".comment-list").css("right")||"0%"===b(".comment-list").css("right"))&&b(".comment-list").css("display","block").animate({right:"0%"},"fast"),b(".comment-list .collection").empty();for(var c in M){var e=M[c];e.parentPath==a.parentCSSPath&&b(".comment-list .collection").append('<a href="#!" class="collection-item" style="line-height:0.5rem;" id="'+c+'"><strong>'+e.twitterName+"</strong>: <br/><em style='color: #252525;'>Highlighted Text</em>: <br/><span class='highlighted-text'>"+e.highlighted_text+"</span><br/><em style='color: #252525;''>Comment</em>: <br/><span class='comment-text'>"+e.comment+"</span></li>")}b(".comment-area textarea").focus(),b(".comment-area textarea").keyup(function(){D.update({comment:b(".comment-area textarea").val()})})}),b(B).on("mousedown",function(){e()}),b(".mdi-editor-format-bold").one("click",p)}function r(){i(b(".mdi-editor-mode-edit")),i(b(".mdi-editor-format-italic")),i(b(".mdi-editor-format-bold")),i(b(".mdi-editor-format-clear")),h(b(this)),g(),b(B).off("mouseup"),b(B).off("mousedown"),b(B).on("mouseup",function(){b(".comment-area textarea").off("keyup");var a=d("#FFFFFF","underline");D=f(a),h(b(".mdi-editor-insert-comment")),("-15%"===b(".comment-area").css("right")||"0%"===b(".comment-area").css("right"))&&b(".comment-area").css("display","block").animate({right:"0%"},"fast"),h(b(".mdi-action-view-headline")),i(b(".mdi-content-archive")),L=!1,("-15%"===b(".comment-list").css("right")||"0%"===b(".comment-list").css("right"))&&b(".comment-list").css("display","block").animate({right:"0%"},"fast"),b(".comment-list .collection").empty();for(var c in M){var e=M[c];e.parentPath==a.parentCSSPath&&b(".comment-list .collection").append('<a href="#!" class="collection-item" style="line-height:0.5rem;" id="'+c+'"><strong>'+e.twitterName+"</strong>: <br/><em style='color: #252525;'>Highlighted Text</em>: <br/><span class='highlighted-text'>"+e.highlighted_text+"</span><br/><em style='color: #252525;''>Comment</em>: <br/><span class='comment-text'>"+e.comment+"</span></li>")}b(".comment-area textarea").focus(),b(".comment-area textarea").keyup(function(){D.update({comment:b(".comment-area textarea").val()})})}),b(B).on("mousedown",function(){e()}),b(this).one("click",s)}function s(){i(b(".mdi-editor-format-color-text")),h(b(".mdi-editor-mode-edit")),g(),b(B).off("mouseup"),b(B).off("mousedown"),b(B).on("mouseup",function(){b(".comment-area textarea").off("keyup");var a=d("#FEC324");D=f(a),h(b(".mdi-editor-insert-comment")),("-15%"===b(".comment-area").css("right")||"0%"===b(".comment-area").css("right"))&&b(".comment-area").css("display","block").animate({right:"0%"},"fast"),h(b(".mdi-action-view-headline")),i(b(".mdi-content-archive")),L=!1,("-15%"===b(".comment-list").css("right")||"0%"===b(".comment-list").css("right"))&&b(".comment-list").css("display","block").animate({right:"0%"},"fast"),b(".comment-list .collection").empty();for(var c in M){var e=M[c];e.parentPath==a.parentCSSPath&&b(".comment-list .collection").append('<a href="#!" class="collection-item" style="line-height:0.5rem;" id="'+c+'"><strong>'+e.twitterName+"</strong>: <br/><em style='color: #252525;'>Highlighted Text</em>: <br/><span class='highlighted-text'>"+e.highlighted_text+"</span><br/><em style='color: #252525;''>Comment</em>: <br/><span class='comment-text'>"+e.comment+"</span></li>")}b(".comment-area textarea").focus(),b(".comment-area textarea").keyup(function(){D.update({comment:b(".comment-area textarea").val()})})}),b(B).on("mousedown",function(){e()}),b(".mdi-editor-format-color-text").one("click",r)}function t(){i(b(".mdi-editor-mode-edit")),i(b(".mdi-editor-format-bold")),i(b(".mdi-editor-format-color-text")),i(b(".mdi-editor-format-clear")),h(b(this)),g(),b(B).off("mouseup"),b(B).off("mousedown"),b(B).on("mouseup",function(){b(".comment-area textarea").off("keyup");var a=d("#FFFFFF","italic");D=f(a),h(b(".mdi-editor-insert-comment")),("-15%"===b(".comment-area").css("right")||"0%"===b(".comment-area").css("right"))&&b(".comment-area").css("display","block").animate({right:"0%"},"fast"),h(b(".mdi-action-view-headline")),i(b(".mdi-content-archive")),L=!1,("-15%"===b(".comment-list").css("right")||"0%"===b(".comment-list").css("right"))&&b(".comment-list").css("display","block").animate({right:"0%"},"fast"),b(".comment-list .collection").empty();for(var c in M){var e=M[c];e.parentPath==a.parentCSSPath&&b(".comment-list .collection").append('<a href="#!" class="collection-item" style="line-height:0.5rem;" id="'+c+'"><strong>'+e.twitterName+"</strong>: <br/><em style='color: #252525;'>Highlighted Text</em>: <br/><span class='highlighted-text'>"+e.highlighted_text+"</span><br/><em style='color: #252525;''>Comment</em>: <br/><span class='comment-text'>"+e.comment+"</span></li>")}b(".comment-area textarea").focus(),b(".comment-area textarea").keyup(function(){D.update({comment:b(".comment-area textarea").val()})})}),b(B).on("mousedown",function(){e()}),b(this).one("click",u)}function u(){i(b(".mdi-editor-format-italic")),h(b(".mdi-editor-mode-edit")),g(),b(B).off("mouseup"),b(B).off("mousedown"),b(B).on("mouseup",function(){b(".comment-area textarea").off("keyup");var a=d("#FEC324");D=f(a),h(b(".mdi-editor-insert-comment")),("-15%"===b(".comment-area").css("right")||"0%"===b(".comment-area").css("right"))&&b(".comment-area").css("display","block").animate({right:"0%"},"fast"),h(b(".mdi-action-view-headline")),i(b(".mdi-content-archive")),L=!1,("-15%"===b(".comment-list").css("right")||"0%"===b(".comment-list").css("right"))&&b(".comment-list").css("display","block").animate({right:"0%"},"fast"),b(".comment-list .collection").empty();for(var c in M){var e=M[c];e.parentPath==a.parentCSSPath&&b(".comment-list .collection").append('<a href="#!" class="collection-item" style="line-height:0.5rem;" id="'+c+'"><strong>'+e.twitterName+"</strong>: <br/><em style='color: #252525;'>Highlighted Text</em>: <br/><span class='highlighted-text'>"+e.highlighted_text+"</span><br/><em style='color: #252525;''>Comment</em>: <br/><span class='comment-text'>"+e.comment+"</span></li>")}b(".comment-area textarea").focus(),b(".comment-area textarea").keyup(function(){D.update({comment:b(".comment-area textarea").val()})})}),b(B).on("mousedown",function(){e()}),b(".mdi-editor-format-italic").one("click",t)}function v(){i(b(".mdi-editor-mode-edit")),i(b(".mdi-editor-format-bold")),i(b(".mdi-editor-format-italic")),i(b(".mdi-editor-format-color-text")),h(b(this)),g(),b(B).off("mouseup"),b(B).off("mousedown"),b(B).on("mouseup",function(){b(".comment-area textarea").off("keyup");var a=d("#FFFFFF","cross");D=f(a),h(b(".mdi-editor-insert-comment")),("-15%"===b(".comment-area").css("right")||"0%"===b(".comment-area").css("right"))&&b(".comment-area").css("display","block").animate({right:"0%"},"fast"),h(b(".mdi-action-view-headline")),i(b(".mdi-content-archive")),L=!1,("-15%"===b(".comment-list").css("right")||"0%"===b(".comment-list").css("right"))&&b(".comment-list").css("display","block").animate({right:"0%"},"fast"),b(".comment-list .collection").empty();for(var c in M){var e=M[c];e.parentPath==a.parentCSSPath&&b(".comment-list .collection").append('<a href="#!" class="collection-item" style="line-height:0.5rem;" id="'+c+'"><strong>'+e.twitterName+"</strong>: <br/><em style='color: #252525;'>Highlighted Text</em>: <br/><span class='highlighted-text'>"+e.highlighted_text+"</span><br/><em style='color: #252525;''>Comment</em>: <br/><span class='comment-text'>"+e.comment+"</span></li>")}b(".comment-area textarea").focus(),b(".comment-area textarea").keyup(function(){D.update({comment:b(".comment-area textarea").val()})})}),b(B).on("mousedown",function(){e()}),b(this).one("click",w)}function w(){i(b(".mdi-editor-format-clear")),h(b(".mdi-editor-mode-edit")),g(),b(B).off("mouseup"),b(B).off("mousedown"),b(B).on("mouseup",function(){b(".comment-area textarea").off("keyup");var a=d("#FEC324");D=f(a),h(b(".mdi-editor-insert-comment")),("-15%"===b(".comment-area").css("right")||"0%"===b(".comment-area").css("right"))&&b(".comment-area").css("display","block").animate({right:"0%"},"fast"),h(b(".mdi-action-view-headline")),i(b(".mdi-content-archive")),L=!1,("-15%"===b(".comment-list").css("right")||"0%"===b(".comment-list").css("right"))&&b(".comment-list").css("display","block").animate({right:"0%"},"fast"),b(".comment-list .collection").empty();for(var c in M){var e=M[c];e.parentPath==a.parentCSSPath&&b(".comment-list .collection").append('<a href="#!" class="collection-item" style="line-height:0.5rem;" id="'+c+'"><strong>'+e.twitterName+"</strong>: <br/><em style='color: #252525;'>Highlighted Text</em>: <br/><span class='highlighted-text'>"+e.highlighted_text+"</span><br/><em style='color: #252525;''>Comment</em>: <br/><span class='comment-text'>"+e.comment+"</span></li>")}b(".comment-area textarea").focus(),b(".comment-area textarea").keyup(function(){D.update({comment:b(".comment-area textarea").val()})})}),b(B).on("mousedown",function(){e()}),b(".mdi-editor-format-clear").one("click",v)}function x(){b(this).hasClass("off-annotation")?h(b(this)):i(b(this)),b(this).one("click",y)}function y(){b(".mdi-action-view-headline").hasClass("on-annotation")?i(b(".mdi-action-view-headline")):h(b(".mdi-action-view-headline")),b(".mdi-action-view-headline").one("click",x)}function z(){b(this).hasClass("off-annotation")?h(b(this)):i(b(this)),L=!0,("-15%"===b(".comment-list").css("right")||"0%"===b(".comment-list").css("right"))&&b(".comment-list").css("display","block").animate({right:"0%"},"fast"),b(".comment-list .collection").empty();for(var a in M){var c=M[a];b(".comment-list .collection").append('<a href="#!" class="collection-item" style="line-height:0.5rem;" id="'+a+'"><strong>'+c.twitterName+"</strong>: <br/><em style='color: #252525;'>Highlighted Text</em>: <br/><span class='highlighted-text'>"+c.highlighted_text+"</span><br/><em style='color: #252525;''>Comment</em>: <br/><span class='comment-text'>"+c.comment+"</span></li>")}b(this).one("click",A)}function A(){L=!1,b(".mdi-content-archive").hasClass("on-annotation")?i(b(".mdi-content-archive")):h(b(".mdi-content-archive")),b(".mdi-content-archive").one("click",z)}var B=b("script#annotate").attr("container");console.log(B),b("<style type='text/css'> .on-annotation{ color:#26A69A; } .off-annotation{ color:#FFFFFF;}</style>").appendTo("head");var C=document.createElement("div");C.className="annotation",C.style.width="5%",C.style.height="50%",C.style.background="#252525",C.style.color="white",C.style.top="25%",C.style.bottom="25%",C.style.position="fixed",C.style.textAlign="center",C.style.right="0px",C.style.fontSize="1.6em",C.style.boxShadow="0px 0px 16px rgba(0, 0, 0, 0.6)",document.body.appendChild(C),b("<i></i>").addClass("mdi-action-account-box").css("display","block").appendTo(".annotation"),b("<i></i>").addClass("mdi-editor-insert-comment off-annotation").css("display","block").appendTo(".annotation"),b("<i></i>").addClass("mdi-editor-mode-edit on-annotation").css("display","block").appendTo(".annotation"),b("<i></i>").addClass("mdi-editor-format-bold off-annotation").css("display","block").appendTo(".annotation"),b("<i></i>").addClass("mdi-editor-format-italic off-annotation").css("display","block").appendTo(".annotation"),b("<i></i>").addClass("mdi-editor-format-color-text off-annotation").css("display","block").appendTo(".annotation"),b("<i></i>").addClass("mdi-editor-format-clear off-annotation").css("display","block").appendTo(".annotation"),b("<i></i>").addClass("mdi-action-view-headline off-annotation").css("display","block").appendTo(".annotation"),b("<i></i>").addClass("mdi-content-archive off-annotation").css({display:"block"}).appendTo(".annotation");var D,E=new Firebase(b("script#annotate").attr("firebase")),F=E.child(window.location.href.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g,"")),G=F.child("comments"),H="404",I="Anonymous",J="@Anonymous",K=null,L=!0,M={},N=document.createElement("div");N.className="comment-area",N.style.background="#252525",N.style.width="15%",N.style.height="20%",N.style.padding="0px 10px",N.style.display="none",N.style.top="0%",N.style.bottom="80%",N.style.position="fixed",N.style.textAlign="center",N.style.right="0%",N.style.overflow="scroll",N.style.color="white",N.style.fontSize="8px",N.style.boxShadow="0px 0px 16px rgba(0, 0, 0, 0.6)",document.body.appendChild(N),b("<div></div>").addClass("input-field").appendTo(".comment-area"),b("<textarea></textarea>").addClass("materialize-textarea").attr("id","textarea1").appendTo(".input-field"),b("<label></label>").attr("for","textarea1").text("Comment").appendTo(".input-field");var O=document.createElement("div");O.className="comment-list container",O.style.background="#252525",O.style.width="15%",O.style.height="20%",O.style.display="none",O.style.top="80%",O.style.bottom="0%",O.style.position="fixed",O.style.textAlign="center",O.style.right="0%",O.style.overflow="scroll",O.style.color="white",O.style.fontSize="8px",O.style.boxShadow="0px 0px 16px rgba(0, 0, 0, 0.6)",document.body.appendChild(O),b("<ul></ul>").addClass("collection").css("border","none").appendTo(".comment-list"),b(B).on("mouseup",function(){b(".comment-area textarea").off("keyup");var a=d("#FEC324");K=a.parentCSSPath,D=f(a),h(b(".mdi-editor-insert-comment")),("-15%"===b(".comment-area").css("right")||"0%"===b(".comment-area").css("right"))&&b(".comment-area").css("display","block").animate({right:"0%"},"fast"),h(b(".mdi-action-view-headline")),i(b(".mdi-content-archive")),L=!1,("-15%"===b(".comment-list").css("right")||"0%"===b(".comment-list").css("right"))&&b(".comment-list").css("display","block").animate({right:"0%"},"fast"),b(".comment-list .collection").empty();for(var c in M){var e=M[c];e.parentPath==a.parentCSSPath&&b(".comment-list .collection").append('<a href="#!" class="collection-item" style="line-height:0.5rem;" id="'+c+'"><strong>'+e.twitterName+"</strong>: <br/><em style='color: #252525;'>Highlighted Text</em>: <br/><span class='highlighted-text'>"+e.highlighted_text+"</span><br/><em style='color: #252525;''>Comment</em>: <br/><span class='comment-text'>"+e.comment+"</span></li>")}b(".comment-area textarea").focus(),b(".comment-area textarea").keyup(function(){D.update({comment:b(".comment-area textarea").val()},P)})});var P=function(a){a?console.log("Synchronization failed!"):console.log("Synchronization succeeded!")};b(B).on("mousedown",function(){e()}),b(".selected-text").on("click",function(){console.log(b(this))}),g(),b(".mdi-editor-format-bold").on("click",function(){b(".annotate").css("color","#26A69A"),b(this).css("color","#26A69A")}),b(".mdi-editor-format-italic").on("click",function(){b(".annotate").css("color","#26A69A"),b(this).css("color","#26A69A")}),b(".mdi-editor-format-color-text").on("click",function(){b(".annotate").css("color","#26A69A"),b(this).css("color","#26A69A")}),G.on("child_added",function(a){var c=a.val(),d=a.name().substring(1);M[d]=c,(c.parentPath===K||L===!0)&&b(".comment-list .collection").append('<a href="#!" class="collection-item" style="line-height:0.5rem;" id="'+d+'"><strong>'+c.twitterName+"</strong>: <br/><em style='color: #252525;'>Highlighted Text</em>: <br/><span class='highlighted-text'>"+c.highlighted_text+"</span><br/><em style='color: #252525;''>Comment</em>: <br/><span class='comment-text'>"+c.comment+"</span></li>")}),G.on("child_changed",function(a){var c=a.val().comment,d=a.name().substring(1);b("#"+d+" span.comment-text").text(c),M[d].comment=c}),G.on("child_removed",function(a){var c=a.name().substring(1);b("#"+c).remove(),delete M[c]}),b(".mdi-action-account-box").on("click",function(){E.authWithOAuthPopup("twitter",function(a,b){a?console.log("Login Failed!",a):(console.log("Authenticated successfully with payload:",b),H=b.uid.split(":")[1],I=b.twitter.displayName,J=b.twitter.username)})}),b(".mdi-editor-insert-comment").one("click",j),b(".mdi-action-view-headline").one("click",m),b(".mdi-editor-format-bold").one("click",p),b(".mdi-editor-format-color-text").one("click",r),b(".mdi-editor-format-italic").one("click",t),b(".mdi-editor-format-clear").one("click",v),b(".mdi-action-view-headline").one("click",x),b(".mdi-content-archive").one("click",z)}(window,jQuery);